---
# This file was originally generated by a template in:
# https://github.com/coreweave/k8s-infrastructure-ansible/blob/master/roles/administrative_tasks/templates/new_zone/values-base-mgmt.yaml.j2
clusterSpec:
  networkAllocations:
    externalLbCIDRs:
      cw-mgmt: 10.81.106.0/23
      dpu: 10.193.63.0/24  # Site specific CIDR for DPU LB
      public: 166.19.39.0/26  # Site specific CIDR for Public LB
  apiserver:
    addtlUrl: api-cw-mgmt.coreweave-mgmt.k8s.us-east-06a.int.coreweave.com
applications:
  box-office:
    namespace: box-office
    valuesMerge:
      box-office:
        registerWithParent: true
      ingress:
        ingressClassName: "traefik-internal"
  control-plane:
    valuesMerge:
      etcd-events:
        replicaCount: 5
      etcd-local:
        replicaCount: 5
      kubeception:
        apiserver:
          service:
            addtlLocalService:
              loadBalancerIP: 10.81.104.11
      pki:
        apiServer:
          ipSans:
          - 127.0.0.1
          - 10.81.104.11
          - 172.27.80.11
          - 172.24.0.1
          - 172.26.64.10
          - 172.26.64.238
  cw-node-controller:
    valuesMerge:
      controllerConfig:
        topologyLabelsEnabled: true
      nodeLifeCycle:
        applyTaints: false
  fleet-lifecycle-controller:
    valuesMerge:
      flcc:
        defaultNodeProfile: "tnt-be1096-fleetops-us-east-06a-default-cpu-fleetops"
  in-cluster-config:
    valuesMerge:
      clusterInfo:
        certificateAuthorityData: "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURiekNDQWxlZ0F3SUJBZ0lRUXNDWWRZWHpCTUtDN3V4cFdaV1BzekFOQmdrcWhraUc5dzBCQVFzRkFEQkMKTVJJd0VBWURWUVFLRXdsRGIzSmxWMlZoZG1VeEZ6QVZCZ05WQkFzVERrbHVabkpoYzNSeWRXTjBkWEpsTVJNdwpFUVlEVlFRREV3cExkV0psY201bGRHVnpNQjRYRFRJME1USXhNakl5TXpRME1Wb1hEVE0wTVRBeU1USXlNelEwCk1Wb3dRakVTTUJBR0ExVUVDaE1KUTI5eVpWZGxZWFpsTVJjd0ZRWURWUVFMRXc1SmJtWnlZWE4wY25WamRIVnkKWlRFVE1CRUdBMVVFQXhNS1MzVmlaWEp1WlhSbGN6Q0NBU0l3RFFZSktvWklodmNOQVFFQkJRQURnZ0VQQURDQwpBUW9DZ2dFQkFQTm9qb0MyQ0ViZFU5RUJMN2FUMDhwSS9ibTdXQndPdzlyNUsrUm1jT0FXYllvZ1lqRXMwZGlBCnpXY1kzNmFrRytQVlJDK3ljbkpwYzZXMHRKUlplcnJpU05yaGFaTEQzVThScjd6WjMrS1hHVFB2VVlvN00xK3gKOEJQRjhkNFVBWE5BMjRWM3FHck15ak9CLy94R0xKa2JTVXNmdUxpTm9sUkI4MVNjc2U4Y2pYSUV4QnZZRzJXRgpwZTFkVW1yRy9IR013c21UTjF4VlppZWk2WjRsMnR3L1J5bVEvNzI0blRzQTl3dGVITXo0ZUFnc1RXdHFKbzl0CmFuN0RzTUJ3MGJOMjZQY3gzY2t1aStWaTc3MTRodCsrS0xRbllpWS9XSyt2ODV1VHhlMWRwZkRMRUxBbS9nQW4KWDRucEpPU2JPR3dwTDJ2aytwV1FMdFNIZWpNMzNtTUNBd0VBQWFOaE1GOHdEZ1lEVlIwUEFRSC9CQVFEQWdLawpNQjBHQTFVZEpRUVdNQlFHQ0NzR0FRVUZCd01CQmdnckJnRUZCUWNEQWpBUEJnTlZIUk1CQWY4RUJUQURBUUgvCk1CMEdBMVVkRGdRV0JCU1lnbnE4U29hTTlnYnN2TVFWbWF6NE1tOGI4akFOQmdrcWhraUc5dzBCQVFzRkFBT0MKQVFFQVpvZEV5alIzRnpEMWQxUkNMNFhNb1duaG5VQ3NmNk85UUs4YVVPanlyc3lHZC9QTC9vTERRb0Zaa3BCcwpuejdvYXRLMGJKajRmUkFKcHl0KzhCOTZRYWFUdWdUV0pleHJZbTNsdlBaVjRkNFErQzE2UjhwWkJ1bVRlWmQ2ClV4V3FUWGtIMGU0RmlISVc0RHo0aUR1c0h1M2dLNXZlR3RYWnFkb0NqWnBIOW9xdjZHa0M2UFAvMVlUS1NhTkkKZ1J5RHJIMW82NC8vL0k4SHFWT0x0NHlMcXNvcVNtWkJTMkNOOVk5WVl5aWYyNFdheThENmRwb2pTTHZvUEJPZwpVZmV0NlpFTkdwa2tOZloxS09vRE1BdHJMRGh0TXVoUFJlR3dRSXd0aEFpdm5SWkVqQnpPNUFudlpwSENCK2JHCmRveXNkMERsRFZZQ1RVM29XeUhZbmZNL1p3PT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo="
      kubeletConfigOverrides:
        maxPods: 256
  nimbus-core-crs:
    enabled: true
  nimbus-bmn-controller:
    enabled: true
    valuesMerge:
      dryRun: false
  teleport-rbac:
    valuesMerge:
      coreweave:
        saml:
          entityDescriptorUrl: https://login.coreweave.com/app/exkltetdhu4hBC34g5d7/sso/saml/metadata # TODO: Teleport setup
  teleport:
    valuesMerge:
      coreweave:
        awxTbot:
          enabled: true
  rook-ceph: # TODO: enable once ceph is available
    enabled: false
  rook-operator:
    enabled: false
  vast-grpc:
    enabled: true
    valueFiles:
      - values-us-east-06a-mgmt.yaml
  vast-csi-controller:
    valuesMerge:
      serviceMonitor:
        enabled: true
  tailscale-operator:
    enabled: false
  metrics:
    valuesMerge:
      portkey:
        monitor:
          enabled: true
          endpoints:
          - ip:
            - 10.193.1.241
            - 10.193.1.242
            - 10.193.1.243
            - 10.193.1.244
            name: US-EAST-06A
            honorTimestamps: false
      ufm:
        monitor:
          enabled: true
          endpoints:
            - ip:
                - 10.193.0.31
                - 10.193.0.56
              name: US-EAST-06A-FAB20
              ports:
                - name: ufm
                  port: 8080
                - name: node-exporter
                  port: 9100
              paths:
                - path: /temperature
                  port: ufm
                  interval: 300s
                  honorTimestamps: false
                - path: /metrics
                  port: node-exporter
              pathGroups:
                - paths:
                  - /cw1
                  - /fabric_verification
                  port: ufm
                  honorTimestamps: false
            - ip:
                - 10.193.8.136
                - 10.193.8.138
              name: US-EAST-06A-FAB21
              ports:
                - name: ufm
                  port: 8080
                - name: node-exporter
                  port: 9100
              paths:
                - path: /temperature
                  port: ufm
                  interval: 300s
                  honorTimestamps: false
                - path: /metrics
                  port: node-exporter
              pathGroups:
                - paths:
                  - /cw1
                  - /fabric_verification
                  port: ufm
                  honorTimestamps: false
  node-assigner:
    enabled: true
    valuesMerge:
      instanceTypes:
        cd-gp-a192-genoa:
          enabled: true
        gd-8xh100ib-i128:
          enabled: true
  npo:
    enabled: false
  npo-cfg:
    enabled: false
  ufm-proxy:
    enabled: true
    valuesMerge:
      config:
        fabrics:
          - name: us-east-06a-fab20
            ufms:
              - address: 10.193.0.31
                port: 443
              - address: 10.193.0.56
                port: 443
          - name: us-east-06a-fab21
            ufms:
              - address: 10.193.8.136
                port: 443
              - address: 10.193.8.138
                port: 443
  ib-partition-controller:
    enabled: true
    valuesMerge:
      config:
        fabrics:
          - name: us-east-06a-fab20
            dryrun: true
          - name: us-east-06a-fab21
            dryrun: true
      coreweave:
        externalSecrets:
          ibpc-us-east-06a-fab20-ufm-token:
            secretStoreName: hpcnet
            data:
              - remoteRef:
                  key: PARTITION_CONTROLLER_FAB20_UFM_TOKEN
                secretKey: UFM_TOKEN
          ibpc-us-east-06a-fab21-ufm-token:
            secretStoreName: hpcnet
            data:
              - remoteRef:
                  key: PARTITION_CONTROLLER_FAB21_UFM_TOKEN
                secretKey: UFM_TOKEN
  ib-bmn-controller:
    enabled: true
    valuesMerge:
      config:
        fabrics:
          - name: us-east-06a-fab20
            dryrun: true
            stripDatahallPrefix: true
          - name: us-east-06a-fab21
            dryrun: true
            stripDatahallPrefix: true
      coreweave:
        externalSecrets:
          ibbc-us-east-06a-fab20-ufm-token:
            secretStoreName: hpcnet
            data:
              - remoteRef:
                  key: BMN_CONTROLLER_FAB20_UFM_TOKEN
                secretKey: UFM_TOKEN
          ibbc-us-east-06a-fab21-ufm-token:
            secretStoreName: hpcnet
            data:
              - remoteRef:
                  key: BMN_CONTROLLER_FAB21_UFM_TOKEN
                secretKey: UFM_TOKEN
  pvmo:
    valuesMerge:
      monitoring:
        enabled: true
        serviceAccount:
          name: vmagent-us-east-06-coreweave-us-east-06a-internal
          namespace: victoria-metrics
