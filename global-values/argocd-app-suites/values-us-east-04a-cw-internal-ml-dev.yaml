clusterSpec:
  region: us-east-04
  scope: ml-dev
  clusterOrg: cw-internal
  networkAllocations:
    additionalLbCIDRs:
      ipam: 166.19.16.0/23

argocd:
  targetClusterURL: https://kube-apiserver.tenant-cw-internal-ml-dev.svc.cluster.local
applications:
  jspolicy-policies:
    values:
      policies:
        mutateNodeTypeGPU: false
  # control-plane & etcd are managed by the Katalyst operator
  control-plane:
    enabled: false
  # katalyst operator manages the konnectivity-agent deployment
  konnectivity-agent:
    enabled: false
  calico-cleanup-controller:
    enabled: true
  calico:
    enabled: true
    valuesMerge:
      typha:
        replicas: 2
      calicoNode:
        calico-node-ebpf:
          nodeSelector:
            kubernetes.io/arch: amd64
        calico-node-ebpf-arm64:
          image: ghcr.io/coreweave/calico/node:v3.28.0-arm64
          nodeSelector:
            kubernetes.io/arch: arm64
  in-cluster-config:
    enabled: false
  node-local-dns:
    enabled: true
  node-pci-exporter:
    valuesMerge:
      image: registry.gitlab.com/coreweave/nascd/node-pci-exporter:multi-arch
      env:
      - name: PCI_TARGETS
        value: "10de:2330,15b3:1021,15b3:a2d6,8086:352a,15b3:101d,1000:c030,10de:22a3,10de:20b2,15b3:101b,8086:347a,1000:c010,10de:1af1,10de:26b5,10de:26b9,10de:2342,15b3:a2dc"
  nfd:
    valuesMerge:
      worker:
        image: ghcr.io/coreweave/nascd/nfd/node-feature-discovery:multi-arch-0.9.0
  nodepools:
    enabled: true
    values:
      nodepools:
        cpu-control-plane:
          targetNodes: 2
        cpu-genoa:
          instanceType: cd-hc-a384-genoa
          targetNodes: 3
        gpu-l40:
          targetNodes: 3
          instanceType: gd-8xl40-i128
        gpu-h100:
          targetNodes: 16
          instanceType: gd-8xh100ib-i128
        gpu-a100:
          targetNodes: 18
          instanceType: gd-8xa100-i128
        gpu-gh200:
          targetNodes: 8
          instanceType: gd-1xgh200
  nvidia-device-plugin:
    valuesMerge:
      image: ghcr.io/coreweave/nascd/k8s-device-plugin:multi-arch-0
      initContainerImage: ubuntu:20.04
  nvidia-device-plugin-sunk:
    valuesMerge:
      image: ghcr.io/coreweave/nascd/k8s-device-plugin:multi-arch-0
      initContainerImage: ubuntu:20.04
  katalyst-proxy:
    valuesMerge:
      loadBalancerIP: 100.124.0.102
  metrics:
    valuesMerge:
      prometheus-operator:
        kubeApiServer:
          enabled: false
  promtail:
    valuesMerge:
      promtail:
        promtail:
          image:
            tag: 3.2.0
          coreweaveLabels:
            cluster: ml-dev
            cluster_org: cw-internal
            region: us-east-04
          config:
            lokiAddress: http://100.124.0.102/loki/api/v1/push
  # Teleport is managed by the katalyst-operator
  teleport:
    enabled: false
  # vast-csi:
  #   hasDedicatedTenant: true
  vast-csi:
    useAllTenantsVipPool: false
    valuesMerge:
      storageClasses:
        shared-vast:
          vipPool: cw-internal-e91dac1
          viewPolicy: nosquash-cw-internal-e91dac1
  pvmo:
    valuesMerge:
      monitoring:
        enabled: true
        serviceAccount:
          name: vmagent-us-east-04-coreweave-us-east-04-ngcp
          namespace: victoria-metrics
