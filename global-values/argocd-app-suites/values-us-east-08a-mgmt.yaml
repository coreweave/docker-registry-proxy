---
clusterSpec:
  networkAllocations:
    externalLbCIDRs:
      cw-mgmt: 10.80.202.0/23
      dpu: 10.187.63.0/24  # Site specific CIDR for DPU LB
      public: 166.19.12.0/26
  apiserver:
    addtlUrl: api-cw-mgmt.coreweave-mgmt.k8s.us-east-08a.int.coreweave.com
applications:
  box-office:
    namespace: box-office
    valuesMerge:
      box-office:
        registerWithParent: true
      ingress:
        ingressClassName: "traefik-internal"
  control-plane:
    valuesMerge:
      etcd-events:
        replicaCount: 5
      etcd-local:
        replicaCount: 5
      kubeception:
        apiserver:
          service:
            addtlLocalService:
              loadBalancerIP: 10.80.200.11
      pki:
        apiServer:
          ipSans:
          - 127.0.0.1
          - 10.80.200.11
          - 172.27.80.11
          - 172.24.0.1
          - 172.26.64.10
          - 172.26.64.238
  cw-node-controller:
    valuesMerge:
      controllerConfig:
        topologyLabelsEnabled: true
      nodeLifeCycle:
        applyTaints: false
  in-cluster-config:
    valuesMerge:
      clusterInfo:
        certificateAuthorityData: "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURjRENDQWxpZ0F3SUJBZ0lSQU1Nc1dmdlhFaklabGpvbUNkUmJtVnN3RFFZSktvWklodmNOQVFFTEJRQXcKUWpFU01CQUdBMVVFQ2hNSlEyOXlaVmRsWVhabE1SY3dGUVlEVlFRTEV3NUpibVp5WVhOMGNuVmpkSFZ5WlRFVApNQkVHQTFVRUF4TUtTM1ZpWlhKdVpYUmxjekFlRncweU5ERXdNVEV5TURFNE1EZGFGdzB6TkRBNE1qQXlNREU0Ck1EZGFNRUl4RWpBUUJnTlZCQW9UQ1VOdmNtVlhaV0YyWlRFWE1CVUdBMVVFQ3hNT1NXNW1jbUZ6ZEhKMVkzUjEKY21VeEV6QVJCZ05WQkFNVENrdDFZbVZ5Ym1WMFpYTXdnZ0VpTUEwR0NTcUdTSWIzRFFFQkFRVUFBNElCRHdBdwpnZ0VLQW9JQkFRQzZwZEkwSnF6YkVnRFBDamdLbzRQRUpha2Iyc3BvZXhoK3laWWVqUm9VMWRXRXVpTkZMc2hkCmIrS3cxR1ZFZ1VYbFp3K1F2YStXSFUyZ0JzaTZmaVBiWklpcCsraCtoVmEzeSsvWmVEcnhJUTkwZ1NaY3ZuWjMKRk95eUFxakRDbHlBc29LVnF1aUdWWWpveUgvOEdJWmRHSllLVm9STDdNcmcyajBCKzlpTEF6QkJEV3VocnIrbApzK2FNTkowZ2ZxUlorTTI0M0ZpN21aZW5MWStYQW5QVFRTTXJqeWlLMml4M2dwWWx5TjB3N2F2c2Q4cjFzTm5NCkFaZUZMT0NvcUp4a3hHeXpyNW1NVmwyVEZnem9icWNHNjYwWEVWU3FQSlN0LzdrM2IwTyt2WVo4YWk2UzFGcmgKcnRpNHlxS1djcE9hMWFyK1B6cVMyUlFmZ0dmQjkrOXJBZ01CQUFHallUQmZNQTRHQTFVZER3RUIvd1FFQXdJQwpwREFkQmdOVkhTVUVGakFVQmdnckJnRUZCUWNEQVFZSUt3WUJCUVVIQXdJd0R3WURWUjBUQVFIL0JBVXdBd0VCCi96QWRCZ05WSFE0RUZnUVUwdWQ0alN5MzdNN09FcjBxQTYrQjAwdlA5dUF3RFFZSktvWklodmNOQVFFTEJRQUQKZ2dFQkFEN0dYY1NZVW41aHJzS3gzL2FnVDNWL1JuamkyOFd5M1VMQlhQZlk2MWdudXViNTVTZkZLaHVwdmdMUAp0Sk94SjFrOE9MUjlXNzJKb0RKNXIwZ0M5OS9PaHJEbVNESHJiRGRCaDZLV21SWmRtTEpORWd1M1p2SnpQbFAyCkFteE5qUjBWWkFkSXVRY0Jpb2R2UFdORDFQUDE3N3EyemE2VVdZb1I4UG9OSzl2TzVGMllHZ3I4U0NGL0RKZDgKeVd0bHp6dDZLdUlEdURsQ0RTRnhscVBRTVhNZDh5S0hzZEprRXJhaVluQVhFRnJNL25hY1RqUUpNTGpEblFORQp1MWZIWmIwc2JkOFV4akVUK0lxakNUVTl4OFpzVVY1YjFiL0lnaVROQnFibXBRRzVOVTFnODQxT2tuTURCTWRVCmtrUGIrQkdKQnpMN2Jqc2Q5bW1UQlhIZy8wZz0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo="
      kubeletConfigOverrides:
        maxPods: 256
  nimbus-core-crs:
    enabled: true
  nimbus-bmn-controller:
    enabled: true
    valuesMerge:
      dryRun: false
  teleport-rbac:
    valuesMerge:
      coreweave:
        saml:
          entityDescriptorUrl: https://login.coreweave.com/app/exkkg4wo1tX2el8FP5d7/sso/saml/metadata # TODO: Teleport setup
  teleport:
    valuesMerge:
      coreweave:
        awxTbot:
          enabled: true
  rook-ceph: # TODO: enable once ceph is available
    enabled: false
  rook-operator:
    enabled: false
  vast-grpc:
    enabled: true
    valueFiles:
      - values-us-east-08a-mgmt.yaml
  vast-csi-controller:
    valuesMerge:
      serviceMonitor:
        enabled: true
  tailscale-operator:
    enabled: false
  metrics:
    valuesMerge:
      portkey:
        monitor:
          enabled: true
          endpoints:
          - ip:
            - 10.187.1.241
            - 10.187.1.242
            - 10.187.1.243
            - 10.187.1.244
            name: US-EAST-08A
            honorTimestamps: false
      ufm:
        monitor:
          enabled: true
          endpoints:
            - ip:
                - 10.187.0.23
                - 10.187.0.41
              name: US-EAST-08A-FAB17
              ports:
                - name: ufm
                  port: 8080
                - name: lowfreq
                  port: 9002
                - name: node-exporter
                  port: 9100
              paths:
                - path: /temperature
                  port: ufm
                  interval: 300s
                  honorTimestamps: false
                - path: /metrics
                  port: node-exporter
                - path: /low_freq
                  port: lowfreq
                  interval: 300s
              pathGroups:
                - paths:
                  - /cw1
                  - /cw2
                  - /fabric_verification
                  port: ufm
                  honorTimestamps: false
  npo:
    enabled: false
  npo-cfg:
    enabled: false
  ufm-proxy:
    enabled: true
    valuesMerge:
      config:
        fabrics:
          - name: fab17
            ufms:
              - address: 10.187.0.23
                port: 443
              - address: 10.187.0.41
                port: 443
  ib-partition-controller:
    enabled: true
    valuesMerge:
      config:
        partitionLabelSelector: ds.coreweave.com/physical-topology.region=US-EAST-08
        ufmHost: ufm-proxy-fab17.hpcnet.svc.cluster.local
      coreweave:
        externalSecrets:
          ufm-token:
            secretStoreName: hpcnet
            data:
              - remoteRef:
                  key: PARTITION_CONTROLLER_FAB17_UFM_TOKEN
                secretKey: UFM_TOKEN
  ib-bmn-controller:
    enabled: true
    valuesMerge:
      config:
        partitionLabelSelector: ds.coreweave.com/physical-topology.region=US-EAST-08
        ufmHost: ufm-proxy-fab17.hpcnet.svc.cluster.local
      coreweave:
        externalSecrets:
          ib-bmn-controller-ufm-token:
            secretStoreName: hpcnet
            data:
              - remoteRef:
                  key: BMN_CONTROLLER_FAB17_UFM_TOKEN
                secretKey: UFM_TOKEN
  sortinghat-api:
    valuesMerge:
      config:
        bareMetalNodeClientConfig:
          unassignedBMNLabelKey: 'flcc.coreweave.com/org-id'
          unassignedBMNLabelValues:
            - 'cw-internal'
  shat-reservation:
    valuesMerge:
      config:
        bareMetalNodeClientConfig:
          unassignedBMNLabelKey: 'flcc.coreweave.com/org-id'
          unassignedBMNLabelValues:
            - 'cw-internal'
  node-assigner:
    enabled: true
    valuesMerge:
      instanceTypes:
        cd-gp-a192-genoa:
          enabled: true
        cd-gp-i64-erapids:
          enabled: true
        gd-8xh200ib-i128:
          enabled: true
      bareMetalNodeClientConfig:
        unassignedBMNLabelKey: 'flcc.coreweave.com/org-id'
        unassignedBMNLabelValues:
          - 'cw-internal'
  shat-gatekeeper:
    valuesMerge:
      config:
        bareMetalNodeClientConfig:
          unassignedBMNLabelKey: 'flcc.coreweave.com/org-id'
          unassignedBMNLabelValues:
            - 'cw-internal'
  pvmo:
    valuesMerge:
      monitoring:
        enabled: true
        serviceAccount:
          name: vmagent-us-east-08-coreweave-us-east-08a-internal
          namespace: victoria-metrics
